<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garuda Media Stack - Live Streaming Dashboard</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            margin: 0;
            padding: 20px;
            color: #fff;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            padding: 20px 0;
            border-bottom: 2px solid #3498db;
            margin-bottom: 30px;
        }

        .header h1 {
            margin: 0;
            color: #3498db;
            font-size: 2.5em;
            text-shadow: 0 0 20px rgba(52, 152, 219, 0.5);
        }

        .subtitle {
            color: #bbb;
            margin-top: 10px;
            font-size: 1.1em;
        }

        .streaming-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .stream-category {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #3498db;
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .category-title {
            color: #3498db;
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 1px solid #3498db;
            padding-bottom: 10px;
        }

        .stream-item {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid #555;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .stream-item:hover {
            background: rgba(52, 152, 219, 0.1);
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .stream-title {
            font-weight: bold;
            color: #fff;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .stream-info {
            color: #bbb;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .stream-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-live { background: #e74c3c; }
        .status-ready { background: #f39c12; }
        .status-offline { background: #7f8c8d; }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .control-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid #e74c3c;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .control-title {
            color: #e74c3c;
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
        }

        .control-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .control-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .control-btn:hover {
            background: linear-gradient(45deg, #2980b9, #1f618d);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
        }

        .control-btn.stop {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .control-btn.stop:hover {
            background: linear-gradient(45deg, #c0392b, #a93226);
        }

        .subscription-badges {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .badge {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            border: 1px solid #3498db;
        }

        .badge.peacock { background: rgba(255, 165, 0, 0.2); color: #ffa500; border-color: #ffa500; }
        .badge.prime { background: rgba(0, 136, 204, 0.2); color: #0088cc; border-color: #0088cc; }
        .badge.netflix { background: rgba(229, 9, 20, 0.2); color: #e50914; border-color: #e50914; }
        .badge.hdhomerun { background: rgba(34, 139, 34, 0.2); color: #228b22; border-color: #228b22; }

        .status-panel {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #555;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .tuner-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .tuner {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid #555;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .auto-refresh {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid #3498db;
            border-radius: 20px;
            padding: 8px 15px;
            color: #3498db;
            font-size: 0.9em;
        }

        .live-viewer {
            margin-top: 30px;
            text-align: center;
        }

        video {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }
    </style>
</head>
<body>
    <div class="auto-refresh">üîÑ Auto-refresh: ON</div>

    <div class="header">
        <h1>üé¨ Live Streaming Dashboard</h1>
        <div class="subtitle">WWE/AEW ‚Ä¢ New Orleans Saints ‚Ä¢ OTA TV</div>
        <div class="subscription-badges">
            <span class="badge peacock">‚úÖ Peacock</span>
            <span class="badge prime">‚úÖ Prime Video</span>
            <span class="badge netflix">‚úÖ Netflix</span>
            <span class="badge hdhomerun">‚úÖ HDHomeRun Connect (1048EEE4)</span>
        </div>
    </div>

    <div class="control-panel">
        <div class="control-title">üéÆ Stream Controls</div>
        <div class="control-buttons">
            <a href="#" class="control-btn" onclick="startWrestlingStream('raw')">Start WWE Raw</a>
            <a href="#" class="control-btn" onclick="startWrestlingStream('smackdown')">Start WWE SmackDown</a>
            <a href="#" class="control-btn" onclick="startWrestlingStream('dynamite')">Start AEW Dynamite</a>
            <a href="#" class="control-btn" onclick="startWrestlingStream('rampage')">Start AEW Rampage</a>
            <a href="#" class="control-btn" onclick="startSaintsStream()">Start Saints Game</a>
            <a href="#" class="control-btn" onclick="scanHDHomeRun()">Scan OTA Channels</a>
            <a href="#" class="control-btn stop" onclick="stopAllStreams()">‚èπÔ∏è Stop All Streams</a>
        </div>
    </div>

    <div class="streaming-grid">
        <!-- WWE/AEW Streams -->
        <div class="stream-category">
            <div class="category-title">ü•ä Wrestling Streams</div>
            
            <div class="stream-item" data-stream="raw">
                <div class="stream-title">WWE Monday Night Raw</div>
                <div class="stream-info">Mondays 8:00 PM ET ‚Ä¢ Peacock</div>
                <div class="stream-status">
                    <div class="status-indicator status-offline" id="raw-status"></div>
                    <span id="raw-text">Ready</span>
                </div>
            </div>

            <div class="stream-item" data-stream="smackdown">
                <div class="stream-title">WWE Friday Night SmackDown</div>
                <div class="stream-info">Fridays 8:00 PM ET ‚Ä¢ Peacock</div>
                <div class="stream-status">
                    <div class="status-indicator status-offline" id="smackdown-status"></div>
                    <span id="smackdown-text">Ready</span>
                </div>
            </div>

            <div class="stream-item" data-stream="nxt">
                <div class="stream-title">WWE NXT</div>
                <div class="stream-info">Tuesdays 8:00 PM ET ‚Ä¢ Peacock</div>
                <div class="stream-status">
                    <div class="status-indicator status-offline" id="nxt-status"></div>
                    <span id="nxt-text">Ready</span>
                </div>
            </div>

            <div class="stream-item" data-stream="dynamite">
                <div class="stream-title">AEW Wednesday Night Dynamite</div>
                <div class="stream-info">Wednesdays 8:00 PM ET ‚Ä¢ TBS</div>
                <div class="stream-status">
                    <div class="status-indicator status-offline" id="dynamite-status"></div>
                    <span id="dynamite-text">Ready</span>
                </div>
            </div>

            <div class="stream-item" data-stream="rampage">
                <div class="stream-title">AEW Friday Night Rampage</div>
                <div class="stream-info">Fridays 10:00 PM ET ‚Ä¢ TNT</div>
                <div class="stream-status">
                    <div class="status-indicator status-offline" id="rampage-status"></div>
                    <span id="rampage-text">Ready</span>
                </div>
            </div>
        </div>

        <!-- Saints Streams -->
        <div class="stream-category">
            <div class="category-title">‚öúÔ∏è Saints Streams</div>
            
            <div class="stream-item" data-stream="saints-ota">
                <div class="stream-title">Saints Game - Local OTA</div>
                <div class="stream-info">CBS/FOX/NBC ‚Ä¢ HDHomeRun 1048EEE4</div>
                <div class="stream-status">
                    <div class="status-indicator status-ready" id="saints-ota-status"></div>
                    <span id="saints-ota-text">HDHomeRun Ready</span>
                </div>
            </div>

            <div class="stream-item" data-stream="saints-prime">
                <div class="stream-title">Saints - Thursday Night Football</div>
                <div class="stream-info">Amazon Prime Video ‚Ä¢ 4K Available</div>
                <div class="stream-status">
                    <div class="status-indicator status-ready" id="saints-prime-status"></div>
                    <span id="saints-prime-text">Prime Ready</span>
                </div>
            </div>

            <div class="stream-item" data-stream="saints-nfl">
                <div class="stream-title">Saints - NFL Network/Plus</div>
                <div class="stream-info">NFL Network ‚Ä¢ RedZone Available</div>
                <div class="stream-status">
                    <div class="status-indicator status-offline" id="saints-nfl-status"></div>
                    <span id="saints-nfl-text">Standby</span>
                </div>
            </div>
        </div>

        <!-- OTA Channels -->
        <div class="stream-category">
            <div class="category-title">üì∫ Local OTA Channels</div>
            
            <div class="stream-item" data-stream="cbs">
                <div class="stream-title">CBS (WWL-TV)</div>
                <div class="stream-info">Channel 4.1 ‚Ä¢ Saints Primary</div>
                <div class="stream-status">
                    <div class="status-indicator status-ready" id="cbs-status"></div>
                    <span id="cbs-text">Signal Ready</span>
                </div>
            </div>

            <div class="stream-item" data-stream="fox">
                <div class="stream-title">FOX (WVUE)</div>
                <div class="stream-info">Channel 8.1 ‚Ä¢ FOX Sports</div>
                <div class="stream-status">
                    <div class="status-indicator status-ready" id="fox-status"></div>
                    <span id="fox-text">Signal Ready</span>
                </div>
            </div>

            <div class="stream-item" data-stream="nbc">
                <div class="stream-title">NBC (WDSU)</div>
                <div class="stream-info">Channel 6.1 ‚Ä¢ Sunday Night Football</div>
                <div class="stream-status">
                    <div class="status-indicator status-ready" id="nbc-status"></div>
                    <span id="nbc-text">Signal Ready</span>
                </div>
            </div>
        </div>

        <!-- Subscription Services -->
        <div class="stream-category">
            <div class="category-title">üéØ Subscription Services</div>
            
            <div class="stream-item" onclick="window.open('https://www.peacocktv.com', '_blank')">
                <div class="stream-title">Peacock TV</div>
                <div class="stream-info">WWE Network ‚Ä¢ Live WWE Events ‚Ä¢ Sports</div>
                <div class="subscription-badges">
                    <span class="badge peacock">Active Subscription</span>
                </div>
            </div>

            <div class="stream-item" onclick="window.open('https://www.amazon.com/gp/video', '_blank')">
                <div class="stream-title">Amazon Prime Video</div>
                <div class="stream-info">Thursday Night Football ‚Ä¢ Sports Documentaries</div>
                <div class="subscription-badges">
                    <span class="badge prime">Active Subscription</span>
                </div>
            </div>

            <div class="stream-item" onclick="window.open('https://www.netflix.com', '_blank')">
                <div class="stream-title">Netflix</div>
                <div class="stream-info">Sports Documentaries ‚Ä¢ Wrestling Content</div>
                <div class="subscription-badges">
                    <span class="badge netflix">Active Subscription</span>
                </div>
            </div>
        </div>
    </div>

    <!-- HDHomeRun Status Panel -->
    <div class="status-panel">
        <h3>üì° HDHomeRun Connect Status (1048EEE4)</h3>
        <div class="tuner-status">
            <div class="tuner">
                <h4>Tuner 0</h4>
                <div id="tuner0-status">Checking...</div>
                <div id="tuner0-channel">-</div>
            </div>
            <div class="tuner">
                <h4>Tuner 1</h4>
                <div id="tuner1-status">Checking...</div>
                <div id="tuner1-channel">-</div>
            </div>
        </div>
        <div style="margin-top: 15px; text-align: center;">
            <button class="control-btn" onclick="refreshTunerStatus()">üîÑ Refresh Status</button>
            <button class="control-btn" onclick="scanChannels()">üì° Scan Channels</button>
        </div>
    </div>

    <!-- Active Streams -->
    <div class="status-panel">
        <h3>üìπ Active Streams</h3>
        <div id="active-streams">Loading...</div>
        <div style="margin-top: 15px; text-align: center;">
            <a href="admin-full-dashboard.html" class="control-btn">üè† Back to Main Dashboard</a>
        </div>
    </div>

    <!-- Live Stream Viewer -->
    <div class="live-viewer" id="video-player" style="display: none;">
        <h3>üì∫ Live Stream</h3>
        <video id="live-video" controls width="100%" height="auto">
            <source id="video-source" src="" type="application/x-mpegURL">
            Your browser does not support HLS playback.
        </video>
        <div style="margin-top: 10px;">
            <button class="control-btn" onclick="closeVideo()">Close Stream</button>
        </div>
    </div>

    <script>
        // JavaScript for stream management
        function startWrestlingStream(eventType) {
            console.log('Starting wrestling stream:', eventType);
            updateStreamStatus(eventType, 'live', 'Starting...');
            
            // Call backend to start stream
            fetch('/api/start-wrestling', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ event: eventType, quality: '1080p' })
            }).then(response => {
                if (response.ok) {
                    updateStreamStatus(eventType, 'live', 'Live');
                } else {
                    updateStreamStatus(eventType, 'offline', 'Failed');
                }
            });
        }

        function startSaintsStream() {
            console.log('Starting Saints stream');
            updateStreamStatus('saints-ota', 'live', 'Starting...');
            
            fetch('/api/start-saints', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ type: 'regular', quality: '1080p' })
            }).then(response => {
                if (response.ok) {
                    updateStreamStatus('saints-ota', 'live', 'Live via OTA');
                } else {
                    updateStreamStatus('saints-ota', 'offline', 'Failed');
                }
            });
        }

        function stopAllStreams() {
            console.log('Stopping all streams');
            
            fetch('/api/stop-streams', {
                method: 'POST'
            }).then(() => {
                // Reset all status indicators
                document.querySelectorAll('.status-indicator').forEach(indicator => {
                    indicator.className = 'status-indicator status-offline';
                });
                document.querySelectorAll('[id$="-text"]').forEach(text => {
                    text.textContent = 'Stopped';
                });
                refreshStreamStatus();
            });
        }

        function updateStreamStatus(streamName, status, text) {
            const statusElement = document.getElementById(streamName + '-status');
            const textElement = document.getElementById(streamName + '-text');
            
            if (statusElement) {
                statusElement.className = 'status-indicator status-' + status;
            }
            if (textElement) {
                textElement.textContent = text;
            }
        }

        function refreshTunerStatus() {
            // This would fetch HDHomeRun tuner status
            console.log('Refreshing tuner status');
            // Implementation would call HDHomeRun API
        }

        function scanChannels() {
            console.log('Scanning channels');
            // This would trigger channel scan
            fetch('/api/scan-channels', { method: 'POST' });
        }

        function refreshStreamStatus() {
            fetch('/api/stream-status')
                .then(response => response.json())
                .then(data => {
                    const activeStreamsDiv = document.getElementById('active-streams');
                    if (data.active_streams && data.active_streams.length > 0) {
                        let html = '<ul>';
                        data.active_streams.forEach(stream => {
                            html += `<li>${stream.name} (PID: ${stream.pid}) - ${stream.status}</li>`;
                        });
                        html += '</ul>';
                        activeStreamsDiv.innerHTML = html;
                    } else {
                        activeStreamsDiv.innerHTML = 'No active streams';
                    }
                })
                .catch(() => {
                    document.getElementById('active-streams').innerHTML = 'Status unavailable';
                });
        }

        function playStream(streamFile) {
            const videoPlayer = document.getElementById('video-player');
            const video = document.getElementById('live-video');
            const source = document.getElementById('video-source');
            
            source.src = `/streams/${streamFile}`;
            video.load();
            videoPlayer.style.display = 'block';
            video.scrollIntoView({ behavior: 'smooth' });
        }

        function closeVideo() {
            document.getElementById('video-player').style.display = 'none';
        }

        // Auto-refresh stream status every 10 seconds
        setInterval(refreshStreamStatus, 10000);
        
        // Initial load
        refreshStreamStatus();
        
        // Add click handlers for stream items
        document.querySelectorAll('.stream-item[data-stream]').forEach(item => {
            item.addEventListener('click', function() {
                const streamName = this.getAttribute('data-stream');
                if (streamName.includes('ota') || streamName === 'saints-ota') {
                    // For OTA streams, start HDHomeRun stream
                    startSaintsStream();
                } else {
                    // For wrestling streams
                    startWrestlingStream(streamName);
                }
            });
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey) {
                switch(e.key) {
                    case '1': startWrestlingStream('raw'); break;
                    case '2': startWrestlingStream('smackdown'); break;
                    case '3': startWrestlingStream('dynamite'); break;
                    case '4': startWrestlingStream('rampage'); break;
                    case '5': startSaintsStream(); break;
                    case '0': stopAllStreams(); break;
                }
            }
        });

        console.log('üé¨ Garuda Media Stack Streaming Dashboard Loaded');
        console.log('üì° HDHomeRun Connect 1048EEE4 configured');
        console.log('‚úÖ Subscriptions: Peacock, Prime Video, Netflix');
        console.log('‚å®Ô∏è Keyboard shortcuts: Ctrl+1-5 to start streams, Ctrl+0 to stop');
    </script>
</body>
</html>

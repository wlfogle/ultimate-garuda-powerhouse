# SPDX-FileCopyrightText: no
# SPDX-License-Identifier: CC0-1.0
#
# Enhanced Configuration file for Calamares with ZFS support
# Based on Calamares 3.3.14 with ZFS integration for Garuda Linux
---
modules-search: [ local ]

# Sequence section with ZFS support enabled
sequence:
- show:
  - welcome
  - locale  
  - keyboard
  - partition
  - users
  - summary
- exec:
  - partition
  - zfs           # ZFS pool and dataset creation
  - mount         # Mount filesystems
  - unpackfs      # Unpack the filesystem
  - machineid     # Generate machine ID
  - locale        # Set locale
  - keyboard      # Set keyboard
  - localecfg     # Configure locale
  - fstab         # Generate fstab (ZFS datasets don't need fstab entries)
  - zfshostid     # Copy ZFS hostid
  - zfspostcfg    # ZFS post-installation configuration
  - users         # Create users
  - displaymanager # Configure display manager
  - networkcfg    # Configure network
  - hwclock       # Set hardware clock
  - services-systemd # Enable systemd services
  - dracut        # Generate dracut initramfs (Garuda uses dracut, not mkinitcpio)
  - bootloader    # Install bootloader
  - umount        # Unmount filesystems
- show:
  - finished

# Branding
branding: garuda

# Installation prompts
prompt-install: false

# Chroot settings
dont-chroot: false
oem-setup: false

# Required Calamares settings
disable-cancel: false
disable-cancel-during-exec: false
hide-back-and-next-during-exec: false
quit-at-end: false

# Disable unsupported features for ZFS installations
disable:
  - firmwarecfg
